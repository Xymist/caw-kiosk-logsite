<h1 class="title-line"><%=@kiosk.name.upcase%></h1>
<div class="ui stackable doubling two column grid">

  <div class="column">
    <h3>External Visits, by Organisation:</h3>
    <% visit_array = {} %>
    <%@hosts.each do |host|
      if host.visits.where(kiosk: @kiosk).count > 0
        visit_array["#{host.name}"] = host.visits.where(kiosk: @kiosk).count
      end%>
    <%end%>
    <%= pie_chart visit_array.except("82.70.248.237")%>
  </div>

  <div class="column">
    <h3>All Clicks, by hour of day:</h3>
    <%= column_chart @kiosk.visits.group_by_hour_of_day(:time_stamp).count %>
  </div>

  <div class="column">
    <h3>Kiosk Topic Access Frequency</h3>
    <%topic_array = {} %>
    <%@topics.each do |topic|
      if ["82.70.248.237"].include? topic.host.name
        topic_array["#{topic.location.capitalize}"] = @kiosk.visits.where(topic: topic).count %>
      <%end
    end%>
    <%= pie_chart topic_array.except("home")%>
  </div>

  <div class="column">
    <h3>External Topic Access Frequency</h3>
    <% topic_visits = {} %>
    <%@visits.each do |visit|
      unless ["82.70.248.237"].include? visit.host.name
        location = visit.topic.location
        if topic_visits[location]
          topic_visits[location] += 1
        else
          topic_visits[location] = 1
        end
      end
    end%>
    <% topic_visits%>
    <%= pie_chart topic_visits.except("home")%>
  </div>

</div>

<script>
$(document).ready(function() {
  $('#logs_breadcrumb').addClass('active');
});
</script>
